{"ast":null,"code":"import _regeneratorRuntime from\"/usr/share/caddy/learning-mongo/lesson3/front-end/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/usr/share/caddy/learning-mongo/lesson3/front-end/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/usr/share/caddy/learning-mongo/lesson3/front-end/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import axios from'axios';import'./App.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){// setup state\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),tickets=_useState2[0],setTickets=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),name=_useState6[0],setName=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),problem=_useState8[0],setProblem=_useState8[1];var fetchTickets=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"/api/tickets\");case 3:response=_context.sent;setTickets(response.data.tickets);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);setError(\"error retrieving tickets: \"+_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function fetchTickets(){return _ref.apply(this,arguments);};}();var createTicket=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.post(\"/api/tickets\",{name:name,problem:problem});case 3:_context2.next=8;break;case 5:_context2.prev=5;_context2.t0=_context2[\"catch\"](0);setError(\"error adding a ticket: \"+_context2.t0);case 8:case\"end\":return _context2.stop();}}},_callee2,null,[[0,5]]);}));return function createTicket(){return _ref2.apply(this,arguments);};}();var deleteOneTicket=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(ticket){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.delete(\"/api/tickets/\"+ticket.id);case 3:_context3.next=8;break;case 5:_context3.prev=5;_context3.t0=_context3[\"catch\"](0);setError(\"error deleting a ticket\"+_context3.t0);case 8:case\"end\":return _context3.stop();}}},_callee3,null,[[0,5]]);}));return function deleteOneTicket(_x){return _ref3.apply(this,arguments);};}();// fetch ticket data\nuseEffect(function(){fetchTickets();},[]);var addTicket=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(e){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:e.preventDefault();_context4.next=3;return createTicket();case 3:fetchTickets();setName(\"\");setProblem(\"\");case 6:case\"end\":return _context4.stop();}}},_callee4);}));return function addTicket(_x2){return _ref4.apply(this,arguments);};}();var deleteTicket=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(ticket){return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return deleteOneTicket(ticket);case 2:fetchTickets();case 3:case\"end\":return _context5.stop();}}},_callee5);}));return function deleteTicket(_x3){return _ref5.apply(this,arguments);};}();// render results\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[error,/*#__PURE__*/_jsx(\"h1\",{children:\"Create a Ticket\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:addTicket,children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[\"Name:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:name,onChange:function onChange(e){return setName(e.target.value);}})]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[\"Problem:\",/*#__PURE__*/_jsx(\"textarea\",{value:problem,onChange:function onChange(e){return setProblem(e.target.value);}})]})}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Submit\"})]}),/*#__PURE__*/_jsx(\"h1\",{children:\"Tickets\"}),tickets.map(function(ticket){return/*#__PURE__*/_jsxs(\"div\",{className:\"ticket\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"problem\",children:[/*#__PURE__*/_jsx(\"p\",{children:ticket.problem}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsxs(\"i\",{children:[\"-- \",ticket.name]})})]}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){return deleteTicket(ticket);},children:\"Delete\"})]},ticket.id);})]});}export default App;","map":{"version":3,"names":["useState","useEffect","axios","App","tickets","setTickets","error","setError","name","setName","problem","setProblem","fetchTickets","get","response","data","createTicket","post","deleteOneTicket","ticket","delete","id","addTicket","e","preventDefault","deleteTicket","target","value","map"],"sources":["/usr/share/caddy/learning-mongo/lesson3/front-end/src/App.js"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport './App.css';\n\nfunction App() {\n  // setup state\n  const [tickets, setTickets] = useState([]);\n  const [error, setError] = useState(\"\");\n  const [name, setName] = useState(\"\");\n  const [problem, setProblem] = useState(\"\");\n\n  const fetchTickets = async() => {\n    try {      \n      const response = await axios.get(\"/api/tickets\");\n      setTickets(response.data.tickets);\n    } catch(error) {\n      setError(\"error retrieving tickets: \" + error);\n    }\n  }\n  const createTicket = async() => {\n    try {\n      await axios.post(\"/api/tickets\", {name: name, problem: problem});\n    } catch(error) {\n      setError(\"error adding a ticket: \" + error);\n    }\n  }\n  const deleteOneTicket = async(ticket) => {\n    try {\n      await axios.delete(\"/api/tickets/\" + ticket.id);\n    } catch(error) {\n      setError(\"error deleting a ticket\" + error);\n    }\n  }\n\n  // fetch ticket data\n  useEffect(() => {\n    fetchTickets();\n  },[]);\n\n  const addTicket = async(e) => {\n    e.preventDefault();\n    await createTicket();\n    fetchTickets();\n    setName(\"\");\n    setProblem(\"\");\n  }\n\n  const deleteTicket = async(ticket) => {\n    await deleteOneTicket(ticket);\n    fetchTickets();\n  }\n\n  // render results\n  return (\n    <div className=\"App\">\n      {error}\n      <h1>Create a Ticket</h1>\n      <form onSubmit={addTicket}>\n        <div>\n          <label>\n            Name:\n            <input type=\"text\" value={name} onChange={e => setName(e.target.value)} />\n          </label>\n        </div>\n        <div>\n          <label>\n            Problem:\n            <textarea value={problem} onChange={e=>setProblem(e.target.value)}></textarea>\n          </label>\n        </div>\n        <input type=\"submit\" value=\"Submit\" />\n      </form>\n      <h1>Tickets</h1>\n      {tickets.map( ticket => (\n        <div key={ticket.id} className=\"ticket\">\n          <div className=\"problem\">\n            <p>{ticket.problem}</p>\n            <p><i>-- {ticket.name}</i></p>\n          </div>\n          <button onClick={e => deleteTicket(ticket)}>Delete</button>\n        </div>\n      ))}     \n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}